<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>文本笑话大全</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/bootstrap-theme.min.css" rel="stylesheet"/>
    <link href="css/joke.css" rel="stylesheet"/>
</head>
<body>
<!--导航栏部分-->
<div class="navbar navbar-inverse navbar-self navbar-fixed-top" role="navigation" id="menu-nav">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#demo-navbar">
                <span class="sr-only">切换导航</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">笑话大全</a>
        </div>
        <div class="navbar-collapse collapse" id="demo-navbar">
            <ul class="nav navbar-nav">
                <li><a href="joke.html">动态搞笑图</a></li>
                <li ><a href="joke2.html">图片笑话</a></li>
                <li class="active"><a href="joke3.html" >文本笑话</a></li>
                <li><a onclick="openDialog();" >关于我们</a></li>
            </ul>
        </div>
    </div>
</div>
<!--内容区-->
<div class="img-container container" id="myContainer">
    <span class="text-welcome">给你带来欢笑，我十分荣幸！</span>
</div>
<div class="btn-group center ">
    <button type="button" class="btn btn-default btn-primary" id="prev">上一条</button>
    <div class="btn-group">
        <button type="button" class="btn btn-default dropdown-toggle btn-primary" data-toggle="dropdown">
            跳转到
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li id="ten"><a href="#">第10条</a></li>
            <li id="twenty"><a href="#">第20条</a></li>
        </ul>
    </div>
    <button type="button" id="next" class="btn btn-default btn-primary">下一条</button>
</div>

<script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>

<script>
    var container=$("#myContainer");
    var index=1;
    function openDialog() {
        alert("感谢您访问我的网站，这是我利于闲暇时间制作的搞笑类网站，暂时功能还不够完善，今后我会尽快弥补，希望您能谅解。网站的后台接口由易源数据提供，在此对易源数据表示感谢！");
    }
    function formatterDateTime() {
        var date=new Date()
        var month=date.getMonth() + 1
        var datetime = date.getFullYear()
                + ""// "年"
                + (month >= 10 ? month : "0"+ month)
                + ""// "月"
                + (date.getDate() < 10 ? "0" + date.getDate() : date
                        .getDate())
                + ""
                + (date.getHours() < 10 ? "0" + date.getHours() : date
                        .getHours())
                + ""
                + (date.getMinutes() < 10 ? "0" + date.getMinutes() : date
                        .getMinutes())
                + ""
                + (date.getSeconds() < 10 ? "0" + date.getSeconds() : date
                        .getSeconds());
        return datetime;
    }
    function http(url,index) {
        $.ajax({
            type: 'post',
            url: url,
            dataType: 'jsonp',
            data: {
                "showapi_timestamp": formatterDateTime(), //注意要使用当前时间。服务器只处理时间误差10分钟以内的请求
                "showapi_appid": '29541', //这里需要改成自己的appid
                "showapi_sign": '3fd121b3d11845d3bddd36c8e2a6bd6a',  //这里需要改成自己的密钥
                "page":index,
                "maxResult":'1',
            },
            jsonp: 'jsonpcallback',
            error: function(XmlHttpRequest, textStatus, errorThrown) {
                alert("操作失败!");
            },
            success: function(result) {
                console.log(result);//console变量在ie低版本下不能用
                var list=document.getElementById("myContainer");
                list.removeChild(list.childNodes[2]);

                var arry=result.showapi_res_body.contentlist;
                for(var i=0;i<arry.length;i++){
                    container.append('<div class="content"><h5 class="img-title">'+arry[i].title+'</h5><hr class="divider"/> <p class="textJoke"> '+arry[i].text+'</p><hr class="divider"/>');
                }
                console.log(index);
            }
        });
    }
    window.onload=function() {
        var url = 'http://route.showapi.com/341-1';
        http(url, index);
        index++;
        document.getElementById('prev').onclick = function () {
            index--;
            http(url, index);
        }
        document.getElementById('next').onclick = function () {
            index++;
            http(url, index);
        }
        document.getElementById('ten').onclick = function () {
            index = index + 10;
            http(url, index);
        }
        document.getElementById('twenty').onclick = function () {
            index = index + 20;
            http(url, index);
        }
    }
</script>
</body>
</html>